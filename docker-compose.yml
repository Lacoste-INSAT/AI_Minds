# Synapsis — Docker Compose (Development)
# ========================================
# Local development setup with hot-reload.
# For full deployment with Ollama in Docker, use: docker-compose.integrated.yml
#
# Usage:
#   docker-compose up -d           # Start Qdrant + Redis (Ollama runs on host)
#   cd backend && uvicorn backend.main:app --reload   # Run backend with reload
#   cd frontend/synapsis && npm run dev               # Run frontend with reload
#
# Prerequisites:
#   - Ollama installed locally: https://ollama.com
#   - Pull model: ollama pull qwen2.5:0.5b (or phi4-mini for better quality)

version: '3.8'

services:
  # =========================================================================
  # Qdrant — Vector Store for Semantic Search
  # =========================================================================
  qdrant:
    image: qdrant/qdrant:latest
    container_name: synapsis-qdrant
    ports:
      - "6333:6333"
      - "6334:6334"
    volumes:
      - ./data/qdrant:/qdrant/storage
    restart: unless-stopped
    environment:
      - QDRANT__STORAGE__STORAGE_PATH=/qdrant/storage
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:6333/readyz"]
      interval: 10s
      timeout: 5s
      retries: 5

  # =========================================================================
  # Redis — Cache and Event Queue
  # =========================================================================
  redis:
    image: redis:latest
    container_name: synapsis-redis
    ports:
      - "6379:6379"
    restart: unless-stopped
